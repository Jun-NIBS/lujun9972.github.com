#+TITLE: 使用Emacs改进你的英文写作
#+AUTHOR: lujun9972
#+TAGS: Emacs之怒
#+DATE: [2018-06-03 日 21:05]
#+LANGUAGE:  zh-CN
#+OPTIONS:  H:6 num:nil toc:t \n:nil ::t |:t ^:nil -:nil f:t *:t <:nil

* ispell
ispell是Unix下的一个拼写(不仅仅是英文)检查工具，同时它也是Emacs用来调用ispell类工具进行拼写检查的插件名称。

之所以说是ispell类工具是因为Emacs的ispell插件不仅仅支持调用ispell来进行拼写检查，也支持调用aspell/hunspell来进行拼写检查。

而且事实上，aspell已经逐渐取代ispell成为主流。

** 安装aspell
既然Emacs是调用外部工具来做的拼写检查，那么第一步当然是要安装 =aspell= 了
#+BEGIN_SRC shell :dir /sudo:: :results org
  sudo pacman -S aspell --noconfirm
#+END_SRC

#+BEGIN_SRC org
resolving dependencies...
looking for conflicting packages...

Packages (1) aspell-0.60.6.1-5

Total Download Size:   0.57 MiB
Total Installed Size:  3.00 MiB

:: Proceed with installation? [Y/n] 
:: Retrieving packages...
 aspell-0.60.6.1-5-x...     0.0   B  0.00B/s 00:00 [----------------------]   0% aspell-0.60.6.1-5-x...   361.4 KiB   531K/s 00:00 [#############---------]  61% aspell-0.60.6.1-5-x...   587.9 KiB  1760K/s 00:00 [######################] 100%
(0/1) checking keys in keyring                     [----------------------]   0%(1/1) checking keys in keyring                     [######################] 100%
(0/1) checking package integrity                   [----------------------]   0%(1/1) checking package integrity                   [######################] 100%
(0/1) loading package files                        [----------------------]   0%(1/1) loading package files                        [######################] 100%
(0/1) checking for file conflicts                  [----------------------]   0%(1/1) checking for file conflicts                  [######################] 100%
(0/1) checking available disk space                [----------------------]   0%(1/1) checking available disk space                [######################] 100%
:: Processing package changes...
(1/1) installing aspell                            [----------------------]   0%(1/1) installing aspell                            [######################] 100%
Optional dependencies for aspell
    perl: to import old dictionaries [installed]
:: Running post-transaction hooks...
(1/2) Arming ConditionNeedsUpdate...
(2/2) Updating the info directory file...
#+END_SRC

不过光安装 =aspell= 并没什么鸟用，你还需要安装对应的字典.
#+BEGIN_SRC shell :results org
  pacman -Ss  aspell
#+END_SRC

#+BEGIN_SRC org
extra/aspell 0.60.6.1-5 [已安装]
    A spell checker designed to eventually replace Ispell
extra/aspell-de 20161207-1
    German dictionary for aspell
extra/aspell-en 2017.08.24-1
    English dictionary for aspell
extra/aspell-es 1.11-6
    Spanish dictionary for aspell
extra/aspell-fr 0.50.3-7
    French dictionary for aspell
extra/aspell-nl 0.50.2-4
    Dutch dictionary for aspell
community/aspell-ca 2.3.0-2
    Catalan dictionary for aspell
community/aspell-cs 20040614-8
    Czech dictionary for aspell
community/aspell-el 0.08-2
    Greek dictionary for aspell
community/aspell-hu 0.99.4.2-5
    Hungarian spellcheck dictionary for aspell
community/aspell-it 2.2_20050523-6
    Italian dictionary for aspell
community/aspell-pl 20171220-1
    Polish dictionary for aspell
community/aspell-pt 20161001-1
    Portuguese and Brazilian Portuguese dictionary for aspell
community/aspell-ru 0.99f7-7
    Russian dictionary for aspell
community/aspell-sv 0.51-1
    Swedish dictionary for aspell
community/aspell-uk 1.8.0-1
    Ukrainian dictionary for aspell
#+END_SRC

你可以看到aspell有很多个语言的字典，也就是支持多种语言的拼写检查，不过可惜的是不支持中文拼写检查(中文分词是个大问题)。

我们一般用的最多的应该是对英文进行拼写检查吧，因此这里我们来安装英文的字典
#+BEGIN_SRC shell :dir /sudo:: :results org
  sudo pacman -S aspell-en --noconfirm
#+END_SRC

#+BEGIN_SRC org
resolving dependencies...
looking for conflicting packages...

Packages (1) aspell-en-2017.08.24-1

Total Download Size:   1.06 MiB
Total Installed Size:  4.06 MiB

:: Proceed with installation? [Y/n] 
:: Retrieving packages...
 aspell-en-2017.08.2...     0.0   B  0.00B/s 00:00 [----------------------]   0% aspell-en-2017.08.2...   133.6 KiB   216K/s 00:04 [##--------------------]  12% aspell-en-2017.08.2...   551.5 KiB   827K/s 00:00 [###########-----------]  50% aspell-en-2017.08.2...  1087.1 KiB  1874K/s 00:01 [######################] 100%
(0/1) checking keys in keyring                     [----------------------]   0%(1/1) checking keys in keyring                     [######################] 100%
(0/1) checking package integrity                   [----------------------]   0%(1/1) checking package integrity                   [######################] 100%
(0/1) loading package files                        [----------------------]   0%(1/1) loading package files                        [######################] 100%
(0/1) checking for file conflicts                  [----------------------]   0%(1/1) checking for file conflicts                  [######################] 100%
(0/1) checking available disk space                [----------------------]   0%(1/1) checking available disk space                [######################] 100%
:: Processing package changes...
(1/1) installing aspell-en                         [----------------------]   0%(1/1) installing aspell-en                         [######################] 100%
:: Running post-transaction hooks...
(1/1) Arming ConditionNeedsUpdate...
#+END_SRC

你可以试着直接在shell中运行 =aspell -c /tmp/t.txt= 来进行拼写检查，然而你可能会得到一个错误提示
#+BEGIN_EXAMPLE
  [lujun9972@T430S ~]$ aspell -c /tmp/t.txt 
  错误：No word lists can be found for the language "zh_CN".
#+END_EXAMPLE

这是因为aspell会自动根据设置的 =LANG= 变量来查找对应的字典，结果当然是找不到中文的字典咯。

不过你可以通过 =-l en= 来指定语言代码为英文。

#+BEGIN_SRC shell
  aspell -c /tmp/t.txt -l en
#+END_SRC

[[file:./images/screenshot-15.png]]


** 配置ispell插件
Emacs的ispell插件会自动以此查找aspell,ispell和hunspell，并以第一个找到的程序为检查程序。 
因此大多数情况下，你无需特意手工设置拼写程序的名称(ispell-program-name)。

不过默认情况下，Emacs的ispell插件也会根据设置的 =LANG= 变量值来决定使用哪个字典来进行拼写检查，因此很大可能，你有必要设置一下ispell插件用来检查的字典。

ispell插件提供了两个变量来设置字典:

+ ispell-dictionary :: 用于设置全局的默认字典
+ ispell-local-dictionary :: 用来设置当前buffer局部使用的字典

#+BEGIN_SRC emacs-lisp
  (setq ispell-dictionary "en")
#+END_SRC

aspell程序本身还支持很多的选项参数，若要传递这些参数给aspell进程，则可以通过定义 =ispell-extra-args= 来实现。
比如下面配置让aspell不检查小于等于3个字符的单词
#+BEGIN_SRC emacs-lisp
  (setq ispell-extra-args '("\W" "3"))
#+END_SRC

** 使用Ispell进行拼写检查

*** ispell

*** ispell-word

*** ispell-minior-mode

*** ispell-complete-word

*** ispell-kill-ispell
* flyspell-mode
* artbollocks-mode

* langtool
