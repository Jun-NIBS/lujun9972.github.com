<!DOCTYPE html>
<html lang="en">
<head>
  <title>init-file-management-sunrise-commander - 暗无天日</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="author" content="DarkSun" />
  <style>
   #ds-thread #ds-reset .ds-comment-body p {color: #ffffff;}
   #disqus_thread a {color: #00ffff;}
  </style>
  <link rel="stylesheet" media="screen" href="https://lujun9972.github.io/media/css/font.css" rel="stylesheet" type="text/css"/>
  <link rel="stylesheet" href="https://lujun9972.github.io/media/css/main.css" type="text/css">
  <link rel="stylesheet" href="https://lujun9972.github.io/media/css/kdComment.css" type="text/css">
  <script type="text/javascript"
          src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
</head>

  <body class="container">
<div>
  <header class="masthead">
    <h1 class="masthead-title"><a href="https://lujun9972.github.io/">暗无天日</a></h1>
    <p>=============&gt;随便,谢谢</p>
    <nav class="site-nav">
      <div class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z" fill="#ffff00"/>
          <path d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z" fill="#ffff00"/>
          <path d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z" fill="#ffff00"/>
        </svg>
      </div>
      <ul class="trigger">
        <li><a href="https://lujun9972.github.io/tags/">Tags</a></li>
        <li><a href="https://lujun9972.github.io/about/">About</a></li>
        <li><a href="">GitHub</a></li>
        <li><a href="https://lujun9972.github.io/rss.xml">RSS</a></li>
      </ul>
    </nav>
    <form method="get" id="searchform" action="http://www.gfsoso.com/search">
      <input type="text" class="field" name="q" id="s" placeholder="Search">
      <input type="hidden" name="as_sitesearch" value="lujun9972.github.io">
    </form>
  </header>
</div>

<div>
<div class="post">
<h1 class="title">init-file-management-sunrise-commander</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org1c230a4">1. 增加elpa repository</a></li>
<li><a href="#org2fa6527">2. sunrise-commander</a></li>
<li><a href="#org32fc66a">3. The Buttons Extension: making Sunrise a bit more like MC</a></li>
<li><a href="#orgc05591c">4. The Mirror Extension: full read/write access to compressed archives</a></li>
<li><a href="#org736757b">5. The Loop Extension: copying and renaming files in the background</a></li>
<li><a href="#org305034e">6. The PopViewer Extension: making the viewer window float</a></li>
<li><a href="#org0367f07">7. The Mode Line Extension: directory paths always in sight</a></li>
<li><a href="#org8172294">8. The Tabs Extension</a></li>
<li><a href="#org783d07a">9. The Tree Extension</a></li>
<li><a href="#org7cf98c0">10. The Checkpoint Extension</a></li>
<li><a href="#orgd55dca7">11. The Windows Add-ons Extension</a></li>
<li><a href="#org2fdf889">12. provide feature</a></li>
</ul>
</div>
</div>

<div id="outline-container-org1c230a4" class="outline-2">
<h2 id="org1c230a4"><span class="section-number-2">1</span> 增加elpa repository</h2>
<div class="outline-text-2" id="text-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #4f97d7;">(</span>add-to-list 'package-archives '<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"SC"</span>   . <span style="color: #2d9574;">"http://joseito.republika.pl/sunrise-commander/"</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">;</span><span style="color: #2aa1ae; background-color: #292e34;">sunrise-commander&#30340;&#23433;&#35013;&#28304;</span>
<span style="color: #4f97d7;">(</span>package-initialize t<span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-org2fa6527" class="outline-2">
<h2 id="org2fa6527"><span class="section-number-2">2</span> sunrise-commander</h2>
<div class="outline-text-2" id="text-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #4f97d7;">(</span>package-install-new 'sunrise-commander<span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org32fc66a" class="outline-2">
<h2 id="org32fc66a"><span class="section-number-2">3</span> The Buttons Extension: making Sunrise a bit more like MC</h2>
<div class="outline-text-2" id="text-3">
<p>
have written a small extension that may be of help to new users who want to get acquainted fast with the most frequent functions found in the Sunrise Commander and their keybindings. Once installed, it displays a panel with mouse clickable buttons that show some of the most useful actions performed by Sunrise and their respective bindings in the bottom window every time the main panels are invoked.
</p>

<p>
you can execute any of the functions by clicking the appropriate button, but the extension was conceived more as a simple cheat sheet (a very, very limited one, as you can easily learn by pressing the last button, labeled “More…”) than as a real interface to Sunrise and Dired functions. Eventually, if you like this kind of interaction with the program you can add your own commands to the list and let this extension manage the creation and layout of the buttons for you.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #4f97d7;">(</span>package-install-new 'sunrise-x-buttons<span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc05591c" class="outline-2">
<h2 id="orgc05591c"><span class="section-number-2">4</span> The Mirror Extension: full read/write access to compressed archives</h2>
<div class="outline-text-2" id="text-4">
<p>
Unfortunately the access to compressed archives offered by AVFS is limited to read-only operations, so I have written an extension to the Sunrise Commander that provides seamless and effective manipulation of compressed archives in a virtual file system. It is called the Sunrise Mirror Extension and you can get a copy of it here:
</p>

<p>
Lisp:sunrise-x-mirror.el
The ELPA repository at <a href="http://joseito.republika.pl/sunrise-commander/">http://joseito.republika.pl/sunrise-commander/</a>
<a href="http://joseito.republika.pl/sunrise-x-mirror.el.gz">http://joseito.republika.pl/sunrise-x-mirror.el.gz</a>
</p>

<p>
For this extension to work you must have:
</p>

<p>
FUSE + AVFS support in your Sunrise Commander. If you can navigate (read-only) inside compressed archives you already have this.
One of funionfs or unionfs-fuse. Debian lenny (stable distribution) provides packages for both.
Programs required for compressing – at least zip and tar.
Your AVFS mount point (and the value of variable sr-avfs-root) must be in a directory where you have writing access.
</p>

<p>
All this means is that most probably this extension will work out-of-the-box on Linux (or MacOS, or other unices), but you’ll have a hard time to make it work on Windows. It was written on GNU Emacs 23 on Linux and tested on GNU Emacs 22 and 23 for Linux.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">(package-install-new 'sunrise-x-mirror)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org736757b" class="outline-2">
<h2 id="org736757b"><span class="section-number-2">5</span> The Loop Extension: copying and renaming files in the background</h2>
<div class="outline-text-2" id="text-5">
<p>
Not long ago I read in some discussion board a quite nice comment regarding the Sunrise Commander, something on the lines of “beautiful stuff, but it will never be a real file manager as long as emacs remains single-threaded”. The answer any seasoned emacs user would give in such situation would be something like “you may have as many processes as you need - have you ever heard of openwith?” and, in the case of Sunrise, it is mostly right, but there was one small exception that already had had the chance to bug me a lot since I started using Sunrise as my default FM: copying and renaming files bigger than several hundred megabytes is a painful operation that can freeze your emacs for a looong time and toss you out of your flow without a good reason.
</p>

<p>
Then somewhere else I read about this emacs user that launches as many instances of emacs as needed, because memory is cheap these days, and who cares. But that didn’t look to me like something I could seriously suggest to an annoyed user.
</p>

<p>
So I wrote a new extension to the Sunrise Commander that allows to execute asynchronously this kind of tasks. Actually it does launch a separate elisp interpreter (with a limited set of functions loaded) and delegates to it the dirty work, but it also manages automatically the life cycle of this new instance and all the communication between the main and the background ones. In order to perform your copy or rename operation in the background, the only thing you have to do is add an empty prefix to the usual keystroke (e.g. C will perform a regular copy in the foreground and C-u C will do it in the background).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #4f97d7;">(</span>package-install-new 'sunrise-x-loop<span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org305034e" class="outline-2">
<h2 id="org305034e"><span class="section-number-2">6</span> The PopViewer Extension: making the viewer window float</h2>
<div class="outline-text-2" id="text-6">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #4f97d7;">(</span>package-install-new 'sunrise-x-popviewer<span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org0367f07" class="outline-2">
<h2 id="org0367f07"><span class="section-number-2">7</span> The Mode Line Extension: directory paths always in sight</h2>
<div class="outline-text-2" id="text-7">
<p>
Here is a new usability enhancement I’ve just released for the Sunrise Commander window manager: sunrise‐x‐modeline ‐‐ a minor mode that puts the directory path of each Sunrise pane on the mode line of its respective window, so it remains always visible. This spares the need to scroll up long sunrise buffers just to check where exactly you are in the file system.
</p>

<p>
Additionally, three small status icons are shown on the left side of the path. These icons are by default plain ASCII characters, but nicer semi-graphical versions can be used instead by customizing the sr-modeline-use-utf8-marks variable.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #4f97d7;">(</span>package-install-new 'sunrise-x-modeline<span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8172294" class="outline-2">
<h2 id="org8172294"><span class="section-number-2">8</span> The Tabs Extension</h2>
<div class="outline-text-2" id="text-8">
<p>
his extension brings tab‐based navigation to the Sunrise Commander. It adds to the list of optional mechanisms already available in Sunrise for moving around the file system (like regular bookmarks, checkpoints, history rings, materialized virtual buffers, navigable paths and file‐following) another way to maintain a list of selected locations one wants to return later on, or to compose “breadcrumb trails” for complex repetitive operations.
</p>

<p>
The main difference between tabs and other mechanisms is that once a buffer has been assigned to a tab, it will not be killed automatically by Sunrise, so it’s possible to keep it around as long as necessary with all its marks and state untouched. Tabs can be persisted across sessions using the DeskTop feature.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #4f97d7;">(</span>package-install-new 'sunrise-x-tabs<span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org783d07a" class="outline-2">
<h2 id="org783d07a"><span class="section-number-2">9</span> The Tree Extension</h2>
<div class="outline-text-2" id="text-9">
<p>
This extension adds to Sunrise a tree view of directories that can be used for extremely fast navigation, as well as for several basic operations on files and directories. It uses the excellent “tree-widget.el” library written by David Ponce, does work in the console as well as in graphical environments and offers three different sets of key bindings (mouse centric, arrow keys and alphanumeric keys) to easily adapt to a wide variety of usage patterns.
</p>

<p>
Navigation inside compressed archives (via AVFS) is supported in tree views (press # to toggle).
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #4f97d7;">(</span>package-install-new 'sunrise-x-tree<span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7cf98c0" class="outline-2">
<h2 id="org7cf98c0"><span class="section-number-2">10</span> The Checkpoint Extension</h2>
<div class="outline-text-2" id="text-10">
<p>
Beginning with version 4 of the Sunrise Commander, checkpoints were redefined to be a special form of bookmarks. Unfortunately, the differences between the bookmarks frameworks in Emacs 22 and Emacs 23 are so big that including this code directly in the sunrise-commander script would make it incompatible with Emacs 22. For this reason both versions of checkpoints are now provided as dynamically loaded extensions, so that you can decide which of them to use. To be sure, this is the version I intend to further develop, as it has a richer set of functions and integrates more nicely to the rest of Emacs. The other one is deprecated and will eventually disappear once Emacs 23+ becomes the “stable” release.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #4f97d7;">(</span>package-install-new 'sunrise-x-checkpoints<span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd55dca7" class="outline-2">
<h2 id="orgd55dca7"><span class="section-number-2">11</span> The Windows Add-ons Extension</h2>
<div class="outline-text-2" id="text-11">
<p>
Not long ago, a user of the Sunrise Commander FM on MS Windows asked me if there are any facilities in SC that would give him easy access to the different drives and special folders in this OS. Since there weren’t any I wrote the Windows Add-ons Extension.
</p>

<p>
This extension implements a listing of all Windows drives and special folders inside the Sunrise Commander, as well as support for symbolic links (shortcuts) for all file system operations inside Sunrise.
</p>

<p>
One caveat, though: this is only for Emacs ports that run directly on the Windows file system (like e.g. EmacsW32) if yours works on top of some simulation layer that maps the file system (such as Cygwin), you don’t need this code.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #4f97d7;">(</span>package-install-new 'sunrise-x-w32-addons<span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org2fdf889" class="outline-2">
<h2 id="org2fdf889"><span class="section-number-2">12</span> provide feature</h2>
<div class="outline-text-2" id="text-12">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">provide</span> '<span style="color: #a45bad;">init-file-management-sunrise-commander</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>

</div>
</div>
<div>
  <div class="post-meta">
    <span title="post date" class="post-info">2015-05-08</span>
    <span title="last modification date" class="post-info">2018-04-29</span>
    <span title="tags" class="post-info">N/A</span>
    <span title="author" class="post-info">DarkSun</span>
  </div>
  <script src="https://lujun9972.github.io/media/js/jquery-2.1.3.min.js"></script>
  <section>
    <h1>Comments</h1>
    <div id="comment-wrap">
      <a class="disqus_label">使用Disqus评论</a>
      <a class="ds-label">使用多说评论</a>
    </ul>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
     //var disqus_developer = 1;
     var preempt_signal=false;
     var disqus_identifier = "/blog/2015/05/08/init-file-management-sunrise-commander/";
     var disqus_url = "https://lujun9972.github.io/blog/2015/05/08/init-file-management-sunrise-commander/";
     var disqus_shortname = 'lujun9972';
     /* * * DON'T EDIT BELOW THIS LINE * * */
     (function() {
       var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
       dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
       (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
       $('#disqus_thread').css('display','none');
     })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </section>
  <script src="https://lujun9972.github.io/media/js/kdComment.js"></script>
  <div class="footer">
    <p>Generated by <a href="http://www.gnu.org/software/emacs/">Emacs</a> 26.x(<a href="http://orgmode.org">Org mode</a> 9.x)</p>
    <p>
      Copyright &copy; 2014 - <span id="footerYear"></span> <a href="mailto:lujun9972 &lt;at&gt; T430S">DarkSun</a>
      &nbsp;&nbsp;-&nbsp;&nbsp;
      Powered by <a href="https://github.com/kelvinh/org-page" target="_blank">org-page</a><br/>
      Themed with <a href="https://github.com/kuangdash/emacs_love" target="_blank">emacs_love</a>
      <script type="text/javascript">document.getElementById("footerYear").innerHTML = (new Date()).getFullYear();</script>
    </p>
  </div>
    </div>

  </body>
</html>
